(function(a){function b(){p=m.querySelector("#searchBox");const b=p.querySelector("input");q=m.querySelector("#searchResults"),n=m.querySelectorAll(".linkList"),o=Array.prototype.reduce.call(n,(a,b)=>{b.category=b.category||k(b);const c=b.querySelectorAll(".linkPreview");return c.forEach(c=>{const d=c.querySelector(".linkPreview-title a"),e=d.href,f=c.querySelector(".linkPreview-eventLocation");a.push({url:e,category:b.category,el:c,title:d.innerText,desc:c.querySelector(".linkPreview-desc").innerText,eventLocation:f?f.innerText:""})}),a},[]),t.addAll(o),a.on(b,["change","input"],s),a.on(b,["keydown"],c),a.on(a,["keydown","click"],c)}function c(a){"click"===a.type?!f(a.target,["#searchBox","#searchResults"])&&e():(("Esc"===a.key||"Escape"===a.key)&&e(),"Enter"===a.key&&r&&f(a.target,["#searchBox"])&&d())}function d(){q.classList.add("isVisible")}function e(){q.classList.remove("isVisible")}function f(a,b){for(let c,d=0;c=b[d++];)for(let b=a;!b.matches("body");){if(b.matches(c))return!0;b=b.parentNode}return!1}function g(a){a.target.value===r||(r=a.target.value,h(r))}function h(a){const b=t.search(a);l(q),0<b.length?(b.forEach(b=>{q.appendChild(j(b,a))}),d()):0<a.length?(q.appendChild(i(a)),d()):e()}function i(){const a=m.createElement("li");return a.classList.add("noResults"),a.appendChild(m.createTextNode("\u2205")),a}function j(a){const b=m.createElement("li"),c=m.createElement("figure"),d=a.el.cloneNode(!0);if(d.classList.add("isClone"),a.category){const a=m.createElement("figcaption");a.appendChild(m.createTextNode(category)),c.appendChild(a)}return c.appendChild(d),c.classList.add("searchResult"),b.appendChild(c),b}function k(a){let b,c=a.parentNode.parentNode.parentNode;for(;c=c.previousElementSibling;){if(c.matches(".collapser")){b=c;break}if(c.matches(".linkList"))break}return!!b&&b.innerText}function l(a){return a.querySelectorAll("*").forEach(a=>{a.remove()})}const m=a.document;let n,o,p,q,r;const s=a.debounce(g,400),t=new a.MiniSearch({idField:"url",fields:["title","desc","eventLocation"],storeFields:["title","desc","eventLocation","el"],searchOptions:{boost:{title:2},prefix:!0,fuzzy:a=>3<a.length?.2:null}});a.on(a,["load"],b)})(this);